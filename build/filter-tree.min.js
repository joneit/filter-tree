!function e(t,r,n){function i(l,a){if(!r[l]){if(!t[l]){var s="function"==typeof require&&require;if(!a&&s)return s(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+l+"'")}var c=r[l]={exports:{}};t[l][0].call(c.exports,function(e){var r=t[l][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[l].exports}for(var o="function"==typeof require&&require,l=0;l<n.length;l++)i(n[l]);return i}({1:[function(e,t,r){"use strict";function n(e,t,r){if("string"==typeof r){if(r=document.querySelector(r),!r)throw"Cannot find reference element for CSS injection."}else if(r&&!(r instanceof Element))throw"Given value not a reference element.";var i=r&&r.parentNode||document.head||document.getElementsByTagName("head")[0];if(!t||(t=n.idPrefix+t,!i.querySelector("#"+t))){var o=document.createElement("style");return o.type="text/css",t&&(o.id=t),e instanceof Array&&(e=e.join("\n")),e="\n"+e+"\n",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e)),void 0===r&&(r=i.firstChild),i.insertBefore(o,r),o}}n.idPrefix="injected-stylesheet-",t.exports=n},{}],2:[function(e,t,r){"use strict";function n(e,t){function r(){t.preInitialize&&t.preInitialize.apply(this,arguments),i.apply(this,arguments),t.postInitialize&&t.postInitialize.apply(this,arguments)}function o(e,r){l[r]=t[e]}switch(arguments.length){case 0:t={};break;case 1:if(t=e,"object"!=typeof t)throw"Single parameter overload must be object.";e=void 0;break;case 2:if("string"!=typeof e||"object"!=typeof t)throw"Two parameter overload must be string, object.";break;default:throw"Too many parameters"}r.extend=n;var l=r.prototype=Object.create(this.prototype);l.constructor=r,e&&n.debug&&(l.$$CLASS_NAME=e);for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];switch(a){case"initializeOwn":break;case"aliases":for(var c in s)s.hasOwnProperty(c)&&o(s[c],c);break;default:"string"==typeof s&&"#"===s[0]?o(s,a.substr(1)):l[a]=s}}return r}function i(){function e(n){var i=Object.getPrototypeOf(n);i.constructor!==Object&&(e(i),i.hasOwnProperty("initialize")&&i.initialize.apply(t,r))}var t=this,r=arguments;e(t)}n.Base=function(){},n.Base.extend=n,t.exports=n},{}],3:[function(require,module,exports){function templex(e){var t=this instanceof Array?this:[this];return arguments.length>1&&t.unshift(arguments),e.replace(templex.regexp,templex.merger.bind(t))}templex.regexp=/\{(.*?)\}/g,templex["with"]=function(e,t){return"with(this["+e+"]){"+t+"}"},templex.cache=[],templex.deref=function(key){if(!(this.length in templex.cache)){for(var code="return eval(expr)",i=0;i<this.length;++i)code=templex["with"](i,code);templex.cache[this.length]=eval("(function(expr){"+code+"})")}return templex.cache[this.length].call(this,key)},templex.merger=function(e,t){var r;try{r=isNaN(t)?templex.deref.call(this,t):this[0][t]}catch(n){r="{"+t+"}"}return r},module.exports=templex},{}],4:[function(e,t,r){"use strict";function n(e,t,r){var n,o=t?"select":"input";if(t&&1===t.length){var l=t[0];n=document.createElement("span"),n.innerHTML=l.text||l;var a=document.createElement("input");a.type="hidden",a.value=l.value||l,n.appendChild(a)}else n=i(o,t,r);return e.appendChild(n),n}function i(e,t,r){var n=document.createElement(e);if(t){var o;"select"===e?(o=n.add,null!==r&&n.add(new Option(r?"("+r+")":""),"")):(o=n.appendChild,n.label=r),t.forEach(function(e){var t;if((e.options||e)instanceof Array){var r=i("optgroup",e.options||e,e.label);n.add(r)}else t="object"==typeof e?new Option(e.text,e.value):new Option(e),o.call(n,t)})}return n}var o=e("./FilterNode"),l={"<":{test:function(e,t){return t>e}},"≤":{test:function(e,t){return t>=e},SQL:"<="},"=":{test:function(e,t){return e===t}},"≥":{test:function(e,t){return e>=t},SQL:">="},">":{test:function(e,t){return e>t}},"≠":{test:function(e,t){return e!==t},SQL:"<>"}},a=o.extend("FilterLeaf",{newView:function(){var e=this.el=document.createElement("span");e.className="filter-tree-default",this.bindings={field:n(e,this.parent.nodeFields||this.fields),operator:n(e,Object.keys(l)),argument:n(e)},e.appendChild(document.createElement("br"))},fromJSON:function(e){var t,r,n;if(e)for(var i in e)if("fields"!==i&&"type"!==i)switch(t=e[i],r=this.bindings[i],r.type){case"checkbox":case"radio":for(r=document.querySelectorAll("input[name='"+r.name+"']"),n=0;n<r.length;n++)r[n].checked=t.indexOf(r[n].value)>=0;break;case"select-multiple":for(r=r.options,n=0;n<r.length;n++)r[n].selected=t.indexOf(r[n].value)>=0;break;default:r.value=t}},testString:function(e){return l[this.bindings.operator.value].test(e,this.bindings.argument.value)},testNumber:function(e,t){var r,n=l[this.bindings.operator.value].test,i=this.bindings.argument.value;return isNaN(t)||isNaN(r=Number(i))?n(e,i):n(t,r)},toJSON:function(){var e,t,r,n,i={};this.type&&(i.type=this.type);for(n in this.bindings){switch(e=this.bindings[n],e.type){case"checkbox":case"radio":for(e=document.querySelectorAll("input[name='"+e.name+"']:enabled:checked"),t=[],r=0;r<e.length;r++)t.push(e[r].value);break;case"select-multiple":for(e=e.options,t=[],r=0;r<e.length;r++)!e.disabled&&e.selected&&t.push(e[r].value);break;default:t=e.value}i[n]=t}return i},toSQL:function(){return[this.bindings.field.value,l[this.bindings.operator.value].SQL||this.bindings.operator.value," '"+this.bindings.argument.value.replace(/'/g,"''")+"'"].join(" ")}});t.exports=a},{"./FilterNode":5}],5:[function(e,t,r){"use strict";var n=e("extend-me"),i=n.Base,o=e("./template");n.debug=!0;var l=i.extend({initialize:function(e){var t=this.parent=e&&e.parent,r=this.json=e&&e.json;if(this.nodeFields=r&&r.nodeFields||e&&(e.nodeFields||e.nodeFields),this.fields=r&&(r.fields||r.fields)||e&&(e.fields||e.fields)||t&&t.fields,!this.nodeFields&&!this.fields)throw this.Error("Expected a fields list.");this.type=r&&r.type||e&&e.type,this.newView(),this.fromJSON(r),this.render()},render:function(){if(this.parent){var e=document.createElement(this.CHILD_TAG);e.appendChild(o("removeButton")),e.appendChild(this.el),this.parent.el.querySelector(this.CHILDREN_TAG).appendChild(e)}},Error:function(e){return new Error("filter-tree: "+e)},CHILDREN_TAG:"OL",CHILD_TAG:"LI",CSS_CLASS_NAME:"filter-tree"});t.exports=l},{"./template":7,"extend-me":2}],6:[function(e,t,r){"use strict";function n(e){var t=e.target,r=this[t.className]||this[t.parentNode.className];r&&(a(),r.call(this,e),e.stopPropagation())}function i(e,t,r){for(var n=p[this.operator],o=n.seed,l=0;l<this.children.length&&o!==n.abort;++l){var a=this.children[l],s=!(a instanceof v);if(s||a.children.length){var c=s?a[r]:i;o=n.reduce(o,c.call(a,e,t))}}return n.negate&&(o=!o),o}function o(){var e=document.createElement("select"),t=Object.keys(v.prototype.editors);return e.className="filter-tree-chooser",e.size=t.length,t.forEach(function(t){e.add(new Option(t))}),e.onmouseover=function(e){e.target.selected=!0},e}function l(e){var t=this,r=e.target.getBoundingClientRect();if(!r.width)return void setTimeout(function(){l.call(t,e)},50);s.style.left=r.left+19+"px",s.style.top=r.bottom+"px",window.addEventListener("click",a),s.onclick=function(){t.children.push(new t.editors[s.value]({parent:t}))},s.onmouseout=function(){s.selectedIndex=-1},g=this.el,g.appendChild(s);var n=g.querySelector(".filter-tree-add-filter");n.style.backgroundColor=window.getComputedStyle(s).backgroundColor}function a(){g&&(s.selectedIndex=-1,g.querySelector(".filter-tree-add-filter").style.backgroundColor=null,g.removeChild(s),s.onclick=s.onmouseout=g=null,window.removeEventListener("click",a))}var s,c,d=e("css-injector"),f=e("./FilterNode"),u=e("./FilterLeaf"),h=e("./template"),p=e("./tree-operators"),m=0;c=".filter-tree{font-family:sans-serif;line-height:1.5em}.filter-tree ol{margin-top:0}.filter-tree-add,.filter-tree-add-filter,.filter-tree-remove{cursor:pointer}.filter-tree-add,.filter-tree-add-filter{font-size:smaller;font-style:italic;margin-left:3em}.filter-tree-add-filter:hover,.filter-tree-add:hover{text-decoration:underline}.filter-tree-add-filter>div,.filter-tree-add>div,.filter-tree-remove{display:inline-block;width:15px;height:15px;border-radius:8px;background-color:#8c8;font-size:11.5px;font-weight:700;color:#fff;text-align:center;line-height:normal;font-style:normal;font-family:sans-serif;text-shadow:0 0 1.5px grey;margin-right:4px}.filter-tree-add-filter>div:before,.filter-tree-add>div:before{content:'\\ff0b'}.filter-tree-remove{background-color:#e88;border:0}.filter-tree-remove:before{content:'\\2212'}.filter-tree li::after{font-size:70%;font-style:italic;font-weight:700;color:#900}.filter-tree>ol>li:last-child::after{display:none}.op-or>ol>li::after{content:'\\A0— OR —'}.op-and>ol>li::after{content:'\\A0— AND —'}.op-nor>ol>li::after{content:'\\A0— NOR —'}.filter-tree-default>*{margin:0 .4em}.filter-tree-chooser{position:absolute;font-style:italic;background-color:#8c8;color:#fff;font-size:11.5px;outline:0;box-shadow:5px 5px 10px grey}";var g,v=f.extend("FilterTree",{initialize:function(e){d(c,"filter-tree-base",e&&e.cssStylesheetReferenceElement),e.editors?(v.prototype.editors=e.editors,s=o()):s||(s=o())},editors:{Default:u},newView:function(){this.el=h("tree",++m),this.el.addEventListener("click",n.bind(this))},fromJSON:function(e){if(e){if("object"!=typeof e){var t="Expected `json` parameter to be an object.";throw"string"==typeof e&&(t+=" See `JSON.parse()`."),this.Error(t)}if(!(e.children instanceof Array&&e.children.length))throw this.Error("Expected `children` field to be a non-empty array.");this.children=[];var r=this;if(e.children.forEach(function(e){var t;if("object"!=typeof e)throw r.Error("Expected child to be an object containing either `children`, `type`, or neither.");t=e.children?v:r.editors[e.type||"Default"],r.children.push(new t({json:e,parent:r}))}),!(p[e.operator]||void 0===e.operator&&1===e.children.length))throw this.Error("Expected `operator` field to be one of: "+Object.keys(p));this.operator=e.operator}else{var n=Object.keys(this.editors),i=1===n.length;this.children=i?[new this.editors[n[0]]({parent:this})]:[],this.operator="op-and"}},render:function(){var e=this.el.querySelector("input[value="+this.operator+"]");if(e.checked=!0,this["filter-tree-choose-operator"]({target:e}),!this.children.length&&Object.keys(this.editors).length>1){var t=this.el.querySelector(".filter-tree-add-filter");this["filter-tree-add-filter"]({target:t})}f.prototype.render.call(this)},"filter-tree-choose-operator":function(e){var t=e.target;this.operator=t.value;var r=this.el.querySelectorAll("label>input.filter-tree-choose-operator[name="+t.name+"]");Array.prototype.slice.call(r).forEach(function(e){e.parentElement.style.textDecoration=e.checked?"none":"line-through"});for(var n in p)this.el.classList.remove(n);this.el.classList.add(this.operator)},"filter-tree-add-filter":function(e){var t=Object.keys(this.editors);1===t.length?this.children.push(new this.editors[t[0]]({parent:this})):l.call(this,e)},"filter-tree-add":function(){this.children.push(new v({parent:this}))},"filter-tree-remove":function(e){var t=e.target,r=t.parentElement,n=this.children,i=t.nextElementSibling;n.forEach(function(e,t){e.el===i&&(delete n[t],r.remove())})},test:function(e){var t=Number(e),r=isNaN(t)?"testString":"testNumber";return i.call(this,e,t,r)},toJSON:function y(){var e={operator:this.operator,children:[]};return this.children.forEach(function(t){var r=!(t instanceof v);(r||t.children.length)&&e.children.push(r?t:y.call(t))}),e},toSQL:function b(){var e=p[this.operator].SQL,t=e.beg;return this.children.forEach(function(r,n){var i=!(r instanceof v);(i||r.children.length)&&(n&&(t+=" "+e.op+" "),t+=i?r.toSQL():b.call(r))}),t+=e.end}});window.FilterTree=v},{"./FilterLeaf":4,"./FilterNode":5,"./template":7,"./tree-operators":8,"css-injector":1}],7:[function(e,t,r){"use strict";function n(e){var t=document.createElement("div"),r=l[e].toString(),n=r.indexOf("/*"),i=r.lastIndexOf("*/");if(-1===n||-1===i)throw"bad template";return n+=2,r=r.substr(n,i-n),r=o.apply(this,[r].concat(Array.prototype.slice.call(arguments,1))),t.innerHTML=r,t.children}function i(){return n.apply(this,arguments)[0]}var o=e("templex"),l={tree:function(){},removeButton:function(){}};i.getAll=n,t.exports=i},{templex:3}],8:[function(e,t,r){"use strict";function n(e,t){return e&&t}function i(e,t){return e||t}t.exports={"op-and":{reduce:n,seed:!0,abort:!1,negate:!1,SQL:{op:"AND",beg:"(",end:")"}},"op-or":{reduce:i,seed:!1,abort:!0,negate:!1,SQL:{op:"OR",beg:"(",end:")"}},"op-nor":{reduce:i,seed:!1,abort:!0,negate:!0,SQL:{op:"OR",beg:"NOT  (",end:")"}}}},{}]},{},[6]);