!function e(t,r,i){function n(l,a){if(!r[l]){if(!t[l]){var s="function"==typeof require&&require;if(!a&&s)return s(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+l+"'")}var c=r[l]={exports:{}};t[l][0].call(c.exports,function(e){var r=t[l][1][e];return n(r?r:e)},c,c.exports,e,t,r,i)}return r[l].exports}for(var o="function"==typeof require&&require,l=0;l<i.length;l++)n(i[l]);return n}({1:[function(e,t,r){"use strict";function i(e,t,r){if("string"==typeof r){if(r=document.querySelector(r),!r)throw"Cannot find reference element for CSS injection."}else if(r&&!(r instanceof Element))throw"Given value not a reference element.";var n=r&&r.parentNode||document.head||document.getElementsByTagName("head")[0];if(!t||(t=i.idPrefix+t,!n.querySelector("#"+t))){var o=document.createElement("style");return o.type="text/css",t&&(o.id=t),e instanceof Array&&(e=e.join("\n")),e="\n"+e+"\n",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e)),void 0===r&&(r=n.firstChild),n.insertBefore(o,r),o}}i.idPrefix="injected-stylesheet-",t.exports=i},{}],2:[function(e,t,r){"use strict";function i(e,t){function r(){t.preInitialize&&t.preInitialize.apply(this,arguments),n.apply(this,arguments),t.postInitialize&&t.postInitialize.apply(this,arguments)}function o(e,r){l[r]=t[e]}switch(arguments.length){case 0:t={};break;case 1:if(t=e,"object"!=typeof t)throw"Single parameter overload must be object.";e=void 0;break;case 2:if("string"!=typeof e||"object"!=typeof t)throw"Two parameter overload must be string, object.";break;default:throw"Too many parameters"}r.extend=i;var l=r.prototype=Object.create(this.prototype);l.constructor=r,e&&i.debug&&(l.$$CLASS_NAME=e);for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];switch(a){case"initializeOwn":break;case"aliases":for(var c in s)s.hasOwnProperty(c)&&o(s[c],c);break;default:"string"==typeof s&&"#"===s[0]?o(s,a.substr(1)):l[a]=s}}return r}function n(){function e(i){var n=Object.getPrototypeOf(i);n.constructor!==Object&&(e(n),n.hasOwnProperty("initialize")&&n.initialize.apply(t,r))}var t=this,r=arguments;e(t)}i.Base=function(){},i.Base.extend=i,t.exports=i},{}],3:[function(require,module,exports){function templex(e){var t=this instanceof Array?this:[this];return arguments.length>1&&t.unshift(arguments),e.replace(templex.regexp,templex.merger.bind(t))}templex.regexp=/\{(.*?)\}/g,templex["with"]=function(e,t){return"with(this["+e+"]){"+t+"}"},templex.cache=[],templex.deref=function(key){if(!(this.length in templex.cache)){for(var code="return eval(expr)",i=0;i<this.length;++i)code=templex["with"](i,code);templex.cache[this.length]=eval("(function(expr){"+code+"})")}return templex.cache[this.length].call(this,key)},templex.merger=function(e,t){var r;try{r=isNaN(t)?templex.deref.call(this,t):this[0][t]}catch(i){r="{"+t+"}"}return r},module.exports=templex},{}],4:[function(e,t,r){"use strict";function i(e,t,r){var i,o=t?"select":"input";if(t&&1===t.length){var l=t[0];i=document.createElement("span"),i.innerHTML=l.text||l;var a=document.createElement("input");a.type="hidden",a.value=l.value||l,i.appendChild(a)}else i=n(o,t,r);return e.appendChild(i),i}function n(e,t,r){var i=document.createElement(e);if(t){var o;"select"===e?(o=i.add,null!==r&&i.add(new Option(r?"("+r+")":""),"")):(o=i.appendChild,i.label=r),t.forEach(function(e){var t;if((e.options||e)instanceof Array){var r=n("optgroup",e.options||e,e.label);i.add(r)}else t="object"==typeof e?new Option(e.text,e.value):new Option(e),o.call(i,t)})}return i}var o=e("./FilterNode"),l=["=","≠","<",">","≤","≥"],a={"≠":"<>","≤":"<=","≥":">="},s=o.extend("FilterLeaf",{newView:function(){var e=this.el=document.createElement("span");e.className="filter-tree-default",this.bindings={field:i(e,this.fields),operator:i(e,l),argument:i(e)},e.appendChild(document.createElement("br"))},fromJSON:function(e){var t,r,i;if(e)for(var n in e)switch(t=e[n],r=this.bindings[n],r.type){case"checkbox":case"radio":for(r=document.querySelectorAll("input[name='"+r.name+"']"),i=0;i<r.length;i++)r[i].checked=t.indexOf(r[i].value)>=0;break;case"select-multiple":for(r=r.options,i=0;i<r.length;i++)r[i].selected=t.indexOf(r[i].value)>=0;break;default:r.value=t}},toJSON:function(){var e,t,r,i,n={};for(i in this.bindings){switch(e=this.bindings[i],e.type){case"checkbox":case"radio":for(e=document.querySelectorAll("input[name='"+e.name+"']:enabled:checked"),t=[],r=0;r<e.length;r++)t.push(e[r].value);break;case"select-multiple":for(e=e.options,t=[],r=0;r<e.length;r++)!e.disabled&&e.selected&&t.push(e[r].value);break;default:t=e.value}n[i]=t}return n},toSQL:function(){return[this.bindings.field.value,a[this.bindings.operator.value]||this.bindings.operator.value," '"+this.bindings.argument.value.replace(/'/g,"''")+"'"].join(" ")}});t.exports=s},{"./FilterNode":5}],5:[function(e,t,r){"use strict";var i=e("extend-me"),n=i.Base,o=e("./template");i.debug=!0;var l=n.extend({initialize:function(e){var t=this.parent=e&&e.parent,r=this.json=e&&e.json;if(this.fields=e&&e.fields||r&&r.fields||t&&t.fields,!this.fields)throw this.Error("No field names list.");this.newView(),this.fromJSON(r),this.render()},render:function(){if(this.parent){var e=document.createElement(this.CHILD_TAG);e.appendChild(o("removeButton")),e.appendChild(this.el),this.parent.el.querySelector(this.CHILDREN_TAG).appendChild(e)}},Error:function(e){return new Error("FilterTree: "+e)},CHILDREN_TAG:"OL",CHILD_TAG:"LI",CSS_CLASS_NAME:"filter-tree"});t.exports=l},{"./template":7,"extend-me":2}],6:[function(e,t,r){"use strict";function i(e){var t=e.target,r=this[t.className]||this[t.parentNode.className];r&&(l(),r.call(this,e),e.stopPropagation())}function n(){var e=document.createElement("select"),t=Object.keys(v.prototype.filterEditors);return e.className="filter-tree-chooser",e.size=t.length,t.forEach(function(t){e.add(new Option(t))}),e.onmouseover=function(e){e.target.selected=!0},e}function o(e){var t=this,r=e.target.getBoundingClientRect();if(!r.width)return void setTimeout(function(){o.call(t,e)},50);a.style.left=r.left+19+"px",a.style.top=r.bottom+"px",window.addEventListener("click",l),a.onclick=function(){t.children.push(new t.filterEditors[a.value]({parent:t}))},a.onmouseout=function(){a.selectedIndex=-1},m=this.el,m.appendChild(a);var i=m.querySelector(".filter-tree-add-filter"),n=i.getBoundingClientRect().width-19;a.getBoundingClientRect().width<n&&(a.style.width=n+"px"),i.style.backgroundColor=window.getComputedStyle(a).backgroundColor}function l(){m&&(a.selectedIndex=-1,m.querySelector(".filter-tree-add-filter").style.backgroundColor=null,m.removeChild(a),a.onclick=a.onmouseout=m=null,window.removeEventListener("click",l))}var a,s,c=e("css-injector"),f=e("./FilterNode"),d=e("./FilterLeaf"),h=e("./template"),u=e("./tree-operators"),p=0;s=".filter-tree{font-family:sans-serif;line-height:1.5em}.filter-tree ol{margin-top:0}.filter-tree-add,.filter-tree-add-filter,.filter-tree-remove{cursor:pointer}.filter-tree-add,.filter-tree-add-filter{font-size:smaller;font-style:italic;margin-left:3em}.filter-tree-add-filter:hover,.filter-tree-add:hover{text-decoration:underline}.filter-tree-add-filter>div,.filter-tree-add>div,.filter-tree-remove{display:inline-block;width:15px;height:15px;border-radius:8px;background-color:#8c8;font-size:11.5px;font-weight:700;color:#fff;text-align:center;line-height:normal;font-style:normal;font-family:sans-serif;text-shadow:0 0 1.5px grey;margin-right:4px}.filter-tree-add-filter>div:before,.filter-tree-add>div:before{content:'\\ff0b'}.filter-tree-remove{background-color:#e88;border:0}.filter-tree-remove:before{content:'\\2212'}.filter-tree li::after{font-size:70%;font-style:italic;font-weight:700;color:#900}.filter-tree>ol>li:last-child::after{display:none}.op-or>ol>li::after{content:'\\A0— OR —'}.op-and>ol>li::after{content:'\\A0— AND —'}.op-nor>ol>li::after{content:'\\A0— NOR —'}.filter-tree-default>*{margin:0 .4em}.filter-tree-chooser{position:absolute;font-style:italic;background-color:#ff0;box-shadow:5px 5px 10px grey}";var m,v=f.extend("FilterTree",{initialize:function(e){a||(a=n(),c(s,"filter-tree-base",e&&e.cssStylesheetReferenceElement))},filterEditors:{Default:d,Bubbles:d},newView:function(){this.el=h("tree",++p),this.el.addEventListener("click",i.bind(this))},fromJSON:function(e){if(e){if("object"!=typeof e){var t="Expected `json` parameter to be an object.";throw"string"==typeof e&&(t+=" See `JSON.parse()`."),this.Error(t)}if(!(e.children instanceof Array&&e.children.length))throw this.Error("Expected `children` field to be a non-empty array.");this.children=[];var r=this;if(e.children.forEach(function(e){var t;if("object"!=typeof e)throw r.Error("Expected child to be an object containing either `children`, `type`, or neither.");t=e.children?v:r.filterEditors[e.type||"Default"],r.children.push(new t({json:e,parent:r}))}),!(u[e.operator]||void 0===e.operator&&1===e.children.length))throw this.Error("Expected `operator` field to be one of: "+Object.keys(u));this.operator=e.operator}else{var i=Object.keys(this.filterEditors),n=1===i.length;this.children=n?[new this.filterEditors[i[0]]({parent:this})]:[],this.operator="op-and"}},render:function(){var e=this.el.querySelector("input[value="+this.operator+"]");if(e.checked=!0,this["filter-tree-choose-operator"]({target:e}),!this.children.length&&Object.keys(this.filterEditors).length>1){var t=this.el.querySelector(".filter-tree-add-filter");this["filter-tree-add-filter"]({target:t})}f.prototype.render.call(this)},"filter-tree-choose-operator":function(e){var t=e.target;this.operator=t.value;var r=this.el.querySelectorAll("label>input.filter-tree-choose-operator[name="+t.name+"]");Array.prototype.slice.call(r).forEach(function(e){e.parentElement.style.textDecoration=e.checked?"none":"line-through"});for(var i in u)this.el.classList.remove(i);this.el.classList.add(this.operator)},"filter-tree-add-filter":function(e){var t=Object.keys(this.filterEditors);1===t.length?this.children.push(new this.filterEditors[t[0]]({parent:this})):o.call(this,e)},"filter-tree-add":function(){this.children.push(new v({parent:this}))},"filter-tree-remove":function(e){var t=e.target,r=t.parentElement,i=this.children,n=t.nextElementSibling;i.forEach(function(e,t){e.el===n&&(delete i[t],r.remove())})},toJSON:function g(){var e={operator:this.operator,children:[]};return this.children.forEach(function(t){var r=!(t instanceof v);(r||t.children.length)&&e.children.push(r?t:g.call(t))}),e},toSQL:function y(){var e=u[this.operator].SQL,t=e.beg;return this.children.forEach(function(r,i){var n=!(r instanceof v);(n||r.children.length)&&(i&&(t+=" "+e.op+" "),t+=n?r.toSQL():y.call(r))}),t+=e.end}});window.FilterTree=v},{"./FilterLeaf":4,"./FilterNode":5,"./template":7,"./tree-operators":8,"css-injector":1}],7:[function(e,t,r){"use strict";function i(e){var t=document.createElement("div"),r=l[e].toString(),i=r.indexOf("/*"),n=r.lastIndexOf("*/");if(-1===i||-1===n)throw"bad template";return i+=2,r=r.substr(i,n-i),r=o.apply(this,[r].concat(Array.prototype.slice.call(arguments,1))),t.innerHTML=r,t.children}function n(){return i.apply(this,arguments)[0]}var o=e("templex"),l={tree:function(){},removeButton:function(){}};n.getAll=i,t.exports=n},{templex:3}],8:[function(e,t,r){"use strict";t.exports={"op-and":{SQL:{op:"AND",beg:"(",end:")"}},"op-or":{SQL:{op:"OR",beg:"(",end:")"}},"op-nor":{SQL:{op:"AND",beg:"NOT  (",end:")"}}}},{}]},{},[6]);