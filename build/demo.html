<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test harness for filter-tree.js</title>

    <script src="filter-tree.js"></script>

    <script>
var filterTree, body;

window.onload = function() {
    body = document.getElementsByTagName('body')[0];
    filterTree = new FilterTree({
        fields: fieldNames,
//        editors: {
//            Default: FilterTree.prototype.editors.Default,
//            Bubbles: FilterTree.prototype.editors.Default,
//        },
//        json: getJSON(document.querySelector('textarea').value)
    });
    body.appendChild(filterTree.el);
};

var fieldNames = [
    { options: ['LastName', 'FirstName'], label: "Names" },
    'BirthState',
    { value:'DOB', text: 'Date Of Birth'}
];

function getJSON(el) {
    try {
        return JSON.parse(el);
    } catch(e) {
        alert('Bad JSON!');
    }
}

function toJSON() {
    document.getElementById('JSON').value = JSON.stringify(filterTree, null, 3);
}

function fromJSON() {
    var oldTree = filterTree;
    filterTree = new FilterTree({
        fields: fieldNames,
        json: getJSON(document.getElementById('JSON').value)
    });
    body.replaceChild(filterTree.el, oldTree.el);
}

function toSQL() {
    document.getElementById('SQL').value = filterTree.toSQL();
}

function test() {
    document.getElementById('test-result').innerHTML = 'yields ' +
        filterTree.test(document.getElementById('test-data').value);
}
    </script>
</head>
<body>
<input type="button" value="toJSON()" onclick="toJSON.call(this)" />
    <textarea id="JSON" style="display:block; margin:1em 0; height:8em; width:30em">{
   "operator": "op-and",
   "children": [
      {
         "field": "LastName",
         "operator": "=",
         "argument": "Clinton"
      },
      {
         "operator": "op-or",
         "children": [
            {
               "field": "DOB",
               "operator": "<",
               "argument": "1990"
            },
            {
               "field": "BirthState",
               "operator": "â‰ ",
               "argument": "Arkansas"
            }
         ]
      }
   ]
}</textarea>
    <input type="button" value="fromJSON()" onclick="fromJSON.call(this)" />
    <hr/>
    <input type="button" value="toSQL()" onclick="toSQL()" />
    <input type="button" value="test()" onclick="test()" style="margin-left:10em"/>
    <span id="test-result"></span>
    <br/>
    <textarea id="SQL" style="margin:1em 0; height:8em; width:14.5em"></textarea>
    <textarea id="test-data" style="margin:1em 0; height:8em; width:14.5em">2300</textarea>
    <hr/>
</body>
</html>
